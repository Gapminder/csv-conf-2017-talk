{"version":3,"sources":["webpack:///webpack/bootstrap 2eeb54993b9ff0d9119c","webpack:///./src/index.js","webpack:///./src/component.js","webpack:///./src/styles.scss?ccec","webpack:///./src/template.html"],"names":["VERSION_INFO","version","build","PopByAge","Vizabi","Tool","extend","init","placeholder","external_model","name","components","component","model","Component","get","_super","validate","entities","state","dimAllPossible","entities_allpossible","dim","Object","keys","show","length","entities_geodomain","skipFilter","entities_side","Boolean","getFilteredEntities","default_model","marker_tags","ui","chart","mode","stacked","inpercent","flipSides","lockActive","lockNonSelected","presentation","locale","versionInfo","utils","helpers","axisSmart","DynamicBackground","TextEllipsis","iconQuestion","iconset","question","config","context","template","require","model_expects","type","_this","model_binds","evt","_readyOnce","time","set","startSelected","Date","timeSteps","endSelected","step","snapped","playing","dragging","snapTime","value","snap","updateStartEnd","groupBy","ready","next","d3","bisectLeft","prev","filter","t","marker","getFrame","frame","frameAxisX","axis_x","_updateEntities","updateBarsOpacity","nextIndex","prevFrameTime","nextFrameTime","fraction","interpolateDiagonal","pValues","nValues","someSelected","select","nonSelectedOpacityZero","path","_highlightBars","stackDim","entitiesProps","color","use","colorConcept","getConceptprops","concept_type","domain","sideConcept","side","which","setWhich","STACKDIM","skipFilterSide","SIDEDIM","geoDomainDimension","sideShow","marker_allpossible","sideDim","entitiesSideProps","clearSideState","clearShow","isEmpty","showEntities","isShown","s","showEntity","doReturn","_entitiesSameDimWithSide","forEach","_space","h","_name","_updateIndicators","_updateSideTitles","_ready","smallMultiples","stackKeys","stackKey","i","_updateLimits","resize","_redrawLocked","entities_age","grouping","getAllSteps","labels","text","switchSideState","lock","stackSkip","yearLocked","_makeOutlines","total","lockedPaths","textEllipsis","xScale","yScale","cScale","xAxis","xAxisLeft","yAxis","xScales","SHIFTEDAGEDIM","domReady","graphTemplate","XMLSerializer","serializeToString","element","node","timeModel","timeYear","formatDate","startYear","start","offset","getTimeOffset","checkDimensions","colorUseConstant","geoLess","sideSkip","readyOnce","el","setTooltip","interaction","_interaction","getDimension","geoDomainDefaultValue","xTitleEl","xInfoEl","yearEl","year","setText","on","_attributeUpdaters","_newWidth","d","width","AGEDIM","ageShift","PREFIXEDSIDEDIM","PREFIXEDSTACKDIM","width_","_newX","prevSbl","previousSibling","prevSblDatum","datum","x_","shiftScale","scaleLinear","range","domains","TIMEDIM","updateUIStrings","_updateGraphs","frameAllColor","frames","maxLimits","inpercentMaxLimits","totals","_createLimits","_getLimits","apFrame","data","graph","selectAll","exit","remove","enter","append","ownerDocument","importNode","DOMParser","parseFromString","documentElement","raise","yAxisEl","xAxisEl","xAxisLeftEl","yTitleEl","title","titleRight","titleCenter","barsCrop","lockedCrop","labelsCrop","bars","parse","lockFrame","lockTime","_interpolateBetweenTotals","dataBetweenFrames","val1","val2","shiftedAge","ageKeys","age","sideKeys","stack","translator","getTFunction","xTitle","conceptPropsX","setIcon","attr","style","Number","description","sourceLink","parent","findChildByName","pin","rect","getBBox","coord","makeAbsoluteContext","farthestViewportElement","x","y","height","toolRect","root","getBoundingClientRect","chartRect","setHook","setPos","left","hide","duration","delayAnimations","axis_y","getScale","tickFormat","getTickFormatter","ageDim","ages","getKeys","map","m","shiftedAgeKeys","slice","reverse","concat","sideItems","label_side","getItems","sideFiltered","getEntity","sides","f","sortFunc","ascending","descending","sort","push","stacks","sortedStackKeys","getPalette","reduce","arr","val","indexOf","stackItems","label_stack","twoSided","xScaleLeft","copy","markers","classed","call","clear","each","sideKeysNF","getNestedItems","geoDefault","ageSum","sideMaxLimits","stackSum","maxSideLimit","Math","max","axisX","domainMin","domainMax","domainScalers","_calcDomainScalers","sumDomains","a","b","nextStep","reorder","prefixedSideDim","prefixedStackDim","timeDim","shiftedAgeDim","o","ageData","outAge","barsData","ageBars","p","oneBarHeight","barHeight","firstBarOffsetY","merge","sideBars","r","activeProfile","centerWidth","stackBars","highlighted","mouseover","mouseout","click","onTap","tap","order","stepShift","transition","ease","easeLinear","interrupt","entityLabels","yearOlds","parseInt","nextAge","KEYS","unique","_getAllDimensions","exceptType","key","line","curve","curveStepBefore","pathsData","_i","stackIndex","j","getValueMD","colorShade","getColorShade","colorID","shadeID","paths","_setYear","timeValue","formattedTime","isTouchDevice","highlightMarker","_showLabel","clearHighlighted","selectMarker","event","stopPropagation","someHighlighted","highlight","formatter","format","deltaX","hoverBarEl","target","labelNode","nodes","labelEl","textData","invert","bbox","transform","getScreenCTM","inverse","multiply","overDrawLeft","e","overDrawRight","min","fullWidth","getGraphWidth","marginBetween","_width","scaler","getYAxisVisibility","index","presentationProfileChanges","medium","margin","top","right","bottom","between","infoElHeight","large","profiles","titlesSpacing","getActiveProfile","deltaMarginTop","graphWidth","warn","_sum","_prevSum","graphWidthSum","round","yScaleCopy","ticks","scale","tickSizeInner","tickSizeOuter","tickPadding","tickSizeMinor","labelerOptions","scaleType","toolMargin","limitMaxTickNumber","fitIntoScale","isPivotAuto","maxRange","translateX","zeroTickEl","tickCount","size","zeroTickBBox","tickNodes","isRTL","titleSpace","wrap","titleBBox","hTranslate","translateY","yearLabelOptions","topOffset","getLayoutProfile","rightOffset","xAlign","yAlign","heightRatio","setConditions","OPACITY_HIGHLT","OPACITY_HIGHLT_DIM","opacityHighlightDim","OPACITY_SELECT","OPACITY_REGULAR","opacityRegular","OPACITY_SELECT_DIM","opacitySelectDim","nonSelectedOpacityZeroFlag","isSelected","isHighlighted","bar"],"mappings":"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","file":"popbyage.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2eeb54993b9ff0d9119c","import \"./styles.scss\";\nimport component from \"./component\";\n\nconst VERSION_INFO = { version: __VERSION, build: __BUILD };\n\n//BAR CHART TOOL\nconst PopByAge = Vizabi.Tool.extend(\"PopByAge\", {\n\n  /**\n   * Initializes the tool (Bar Chart Tool).\n   * Executed once before any template is rendered.\n   * @param {Object} placeholder Placeholder element for the tool\n   * @param {Object} external_model Model as given by the external page\n   */\n  init(placeholder, external_model) {\n\n    this.name = \"popbyage\";\n\n    //specifying components\n    this.components = [{\n      component,\n      placeholder: \".vzb-tool-viz\",\n      model: [\"state.time\", \"state.marker\", \"state.marker_allpossible\", \"state.entities\", \"state.entities_side\", \"state.entities_age\", \"state.entities_allpossible\", \"state.entities_geodomain\", \"locale\", \"ui\"] //pass models to component\n    }, {\n      component: Vizabi.Component.get(\"timeslider\"),\n      placeholder: \".vzb-tool-timeslider\",\n      model: [\"state.time\", \"state.entities\", \"state.marker\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"dialogs\"),\n      placeholder: \".vzb-tool-dialogs\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"buttonlist\"),\n      placeholder: \".vzb-tool-buttonlist\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"treemenu\"),\n      placeholder: \".vzb-tool-treemenu\",\n      model: [\"state.marker\", \"state.marker_tags\", \"state.time\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datanotes\"),\n      placeholder: \".vzb-tool-datanotes\",\n      model: [\"state.marker\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"steppedspeedslider\"),\n      placeholder: \".vzb-tool-stepped-speed-slider\",\n      model: [\"state.time\", \"locale\"]\n    }];\n\n    //constructor is the same as any tool\n    this._super(placeholder, external_model);\n  },\n\n  validate(model) {\n    model = this.model || model;\n\n    this._super(model);\n\n    //validate on first model set only\n    if (!this.model) {\n      const entities = model.state.entities;\n      const dimAllPossible = model.state.entities_allpossible.dim;\n      if (Object.keys(entities.show).length > 0) {\n        const show = {};\n        if (entities.show[entities.dim] && entities.show[entities.dim][\"$in\"]) {\n          show[entities.dim] = {};\n          show[entities.dim][\"$in\"] = entities.show[entities.dim][\"$in\"];\n        }\n        if (entities.dim !== dimAllPossible) {\n          show[\"is--\" + dimAllPossible] = true;\n        }\n        if (!entities.show[entities.dim] || !(Object.keys(entities.show).length == 1)) {\n          entities.show = show;\n        }\n      }\n\n      const entities_geodomain = model.state.entities_geodomain;\n      entities_geodomain.skipFilter = (model.state.entities.dim === entities_geodomain.dim || model.state.entities_side.dim === entities_geodomain.dim) && \n        (Boolean(model.state.entities.getFilteredEntities().length) || !model.state.entities_side.skipFilter);\n    }\n  },\n\n  default_model: {\n    state: {\n      marker_tags: {}\n    },\n    ui: {\n      chart: {\n        mode: \"smallMultiples\",\n        stacked: true,\n        inpercent: false,\n        flipSides: true,\n        lockActive: true,\n        lockNonSelected: 0\n      },\n      \"buttons\": [\"colors\", \"show\", \"lock\", \"side\", \"inpercent\", \"moreoptions\", \"fullscreen\"],\n      \"dialogs\": {\n        \"popup\": [\"timedisplay\", \"colors\", \"show\", \"side\", \"moreoptions\"],\n        \"sidebar\": [\"timedisplay\", \"colors\", \"grouping\", \"show\"],\n        \"moreoptions\": [\"opacity\", \"speed\", \"grouping\", \"colors\", \"side\", \"presentation\", \"about\"]\n      },\n      presentation: false\n    },\n    locale: { }\n  },\n\n  versionInfo: VERSION_INFO\n});\n\nexport default PopByAge;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const {\n  utils,\n  Component,\n  helpers: {\n    \"d3.axisWithLabelPicker\": axisSmart,\n    \"d3.dynamicBackground\": DynamicBackground,\n    \"textEllipsis\": TextEllipsis\n  },\n  iconset: {\n    question: iconQuestion\n  },\n} = Vizabi;\n\n// POP BY AGE CHART COMPONENT\nconst PopByAge = Component.extend(\"popbyage\", {\n\n  /**\n   * Initializes the component (Bar Chart).\n   * Executed once before any template is rendered.\n   * @param {Object} config The config passed to the component\n   * @param {Object} context The component's parent\n   */\n  init(config, context) {\n    this.name = \"popbyage\";\n    this.template = require(\"./template.html\");\n\n    //define expected models for this component\n    this.model_expects = [{\n      name: \"time\",\n      type: \"time\"\n    }, {\n      name: \"marker\",\n      type: \"marker\"\n    }, {\n      name: \"marker_allpossible\",\n      type: \"marker\"\n    }, {\n      name: \"entities\",\n      type: \"entities\"\n    }, {\n      name: \"entities_side\",\n      type: \"entities\"\n    }, {\n      name: \"entities_age\",\n      type: \"entities\"\n    }, {\n      name: \"entities_allpossible\",\n      type: \"entities\"\n    }, {\n      name: \"entities_geodomain\",\n      type: \"entities\"\n    }, {\n      name: \"locale\",\n      type: \"locale\"\n    }, {\n      name: \"ui\",\n      type: \"ui\"\n    }];\n\n    const _this = this;\n    this.model_binds = {\n      \"change:time.startSelected\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this.model.time.set({\n          startSelected: new Date(_this.timeSteps[0])\n        }, false, false);\n\n      },\n      \"change:time.endSelected\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this.model.time.set({\n          endSelected: new Date(_this.timeSteps[_this.timeSteps.length - 1])\n        }, false, false);\n      },\n      \"change:time.value\": function(evt) {\n        if (!_this._readyOnce) return;\n        if (_this.model.time.step != 1 && !_this.snapped && !_this.model.time.playing && !_this.model.time.dragging) {\n          if(_this.snapTime) {\n            if(+_this.snapTime - _this.model.time.value === 0) {\n              _this.snapTime = null;\n              _this.model.time.snap();\n            } else {\n              _this.model.time.value = new Date(_this.snapTime);\n            }\n            return;\n          }\n          if(_this.updateStartEnd(_this.model.time.value, _this.groupBy)) {\n            _this.ready();\n            return;\n          };\n          let next = d3.bisectLeft(_this.timeSteps, _this.model.time.value);\n          if (next != 0 && (_this.timeSteps[next] - _this.model.time.value)) {\n            _this.snapped = true;\n            const time = _this.model.time.value;\n            const prev = _this.timeSteps[next - 1];\n            next = _this.timeSteps[next];\n            const snapTime = (time - prev) < (next - time) ? prev : next;\n            _this.model.time.value = new Date(snapTime);\n          }\n        }\n        if (!_this.snapped) {\n          if (_this.timeSteps.filter(t => (t - _this.model.time.value) == 0).length) {\n            _this.model.marker.getFrame(_this.model.time.value, frame => {\n              if(!frame) return;\n              _this.frame = frame;\n              _this.frameAxisX = frame.axis_x;\n              _this._updateEntities();\n              _this.updateBarsOpacity();\n            });\n          } else if(_this.model.time.value < _this.model.time.startSelected || _this.model.time.value > _this.model.time.endSelected) {\n            _this.snapTime = _this.model.time.value;\n          } else {\n            _this.snapTime = null;\n            const nextIndex = d3.bisectLeft(_this.timeSteps, _this.model.time.value);\n            const prevFrameTime = _this.timeSteps[nextIndex - 1];\n            const nextFrameTime = _this.timeSteps[nextIndex];\n            const fraction = (_this.model.time.value - prevFrameTime) / (nextFrameTime - prevFrameTime);\n            _this.model.marker.getFrame(nextFrameTime, nValues => {\n              _this.model.marker.getFrame(prevFrameTime, pValues => {\n                _this.frameAxisX = _this.interpolateDiagonal(pValues.axis_x, nValues.axis_x, fraction);\n                _this._updateEntities();\n                _this.updateBarsOpacity();\n              });\n            });\n          }\n        }\n        _this.snapped = false;\n      },\n      \"change:marker.select\": function(evt) {\n        _this.someSelected = (_this.model.marker.select.length > 0);\n        _this.nonSelectedOpacityZero = false;\n        _this.updateBarsOpacity();\n      },\n      \"change:marker.highlight\": function(evt, path) {\n        if (!_this._readyOnce) return;\n        _this._highlightBars();\n      },\n      \"change:marker.opacitySelectDim\": function() {\n        _this.updateBarsOpacity();\n      },\n      \"change:marker.opacityRegular\": function() {\n        _this.updateBarsOpacity();\n      },\n      \"change:marker.color.palette\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this._updateEntities(true);\n      },\n      \"change:marker.color.scaleType\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this._updateEntities();\n      },\n      \"change:marker.color.which\": function(evt) {\n        if (!_this._readyOnce) return;\n        let stackDim;\n        const show = {};\n        const entitiesProps = {}\n        if (_this.model.marker.color.use == \"constant\") {\n          stackDim = null;\n        } else {\n          const colorConcept = _this.model.marker.color.getConceptprops();\n          if (colorConcept.concept_type == \"entity_set\") {\n            stackDim = colorConcept.domain;\n            //show[\"is--\" + _this.model.marker.color.which] = true;\n            show[stackDim] = {};\n            const sideConcept = _this.model.marker.side.getConceptprops();\n            if (sideConcept.concept_type == \"entity_set\" && stackDim == sideConcept.domain && _this.model.marker.side.which !== _this.model.marker.color.which) {\n              _this.model.marker.side.setWhich({\"concept\" : _this.model.marker.color.which});\n            }\n          } else {\n            stackDim = _this.model.marker.color.which;\n          }\n        }\n        if (_this.STACKDIM !== stackDim) {\n          entitiesProps[\"show\"] = show;\n        }\n        entitiesProps[\"dim\"] = stackDim;\n        const skipFilterSide = _this.SIDEDIM !== _this.geoDomainDimension || _this.model.marker.color.which === _this.model.marker.side.which;\n        if (!skipFilterSide) {\n          const sideShow = {};\n          sideShow[\"is--\" + _this.model.marker.side.which] = true;\n          _this.model.entities_side.set(\"show\", sideShow);\n        }\n        _this.model.entities_side.skipFilter = skipFilterSide;\n        _this.model.entities.set(entitiesProps);\n        _this.model.entities_geodomain.skipFilter = (stackDim === _this.geoDomainDimension || _this.SIDEDIM === _this.geoDomainDimension) &&\n          (Boolean(_this.model.entities.getFilteredEntities().length) || !_this.model.entities_side.skipFilter);\n        _this.model.entities_allpossible.set(\"dim\", stackDim);\n        _this.model.marker_allpossible.color.set(\"which\", _this.model.marker.color.which);\n      },\n      \"change:marker.side.which\": function(evt) {\n        if (!_this._readyOnce) return;\n        let sideDim;\n        const show = {};\n        const entitiesSideProps = {}\n        if (_this.model.marker.side.use == \"constant\") {\n          sideDim = null;\n        } else {\n          const sideConcept = _this.model.marker.side.getConceptprops();\n          if (sideConcept.concept_type == \"entity_set\") {\n            sideDim = sideConcept.domain;\n            const colorConcept = _this.model.marker.color.getConceptprops();\n            if (colorConcept.concept_type == \"entity_set\" && sideDim == colorConcept.domain && _this.model.marker.color.which !== _this.model.marker.side.which) {\n              _this.model.marker.color.setWhich({\"concept\" : _this.model.marker.side.which});\n            }\n          } else {\n            sideDim = _this.model.marker.side.which;\n          }\n        }\n//        const sideDim = _this.model.marker.side.use == \"constant\" ? null : _this.model.marker.side.which;\n        _this.model.marker.side.clearSideState();\n        const skipFilterSide = sideDim !== _this.geoDomainDimension || _this.model.marker.color.which === _this.model.marker.side.which;\n        if (!skipFilterSide) {\n          show[\"is--\" + _this.model.marker.side.which] = true;\n        }\n        _this.model.entities_side.skipFilter = skipFilterSide;\n        entitiesSideProps[\"show\"] = show;\n        entitiesSideProps[\"dim\"] = sideDim;\n//        _this.model.entities_side.clearShow();\n        _this.model.entities_side.set(entitiesSideProps);\n        _this.model.entities_geodomain.skipFilter = (sideDim === _this.geoDomainDimension || _this.STACKDIM === _this.geoDomainDimension) &&\n          (Boolean(_this.model.entities.getFilteredEntities().length) || !_this.model.entities_side.skipFilter);\n        if(_this.model.marker.color.which === _this.model.marker.side.which) {\n          _this.model.entities.clearShow();\n        }\n      },\n      \"change:entities.show\": function(evt) {\n        if (!_this._readyOnce) return;\n        if (_this.model.entities.dim === _this.model.entities_side.dim\n          && !utils.isEmpty(_this.model.entities_side.show)) {\n          const showEntities = _this.model.entities_side.getFilteredEntities().filter(s => !_this.model.entities.isShown(s));\n          if (showEntities.length) {\n            _this.model.marker.side.clearSideState();\n            _this.model.entities_side.showEntity(showEntities);\n          }\n        }\n        _this.model.entities_geodomain.skipFilter = (_this.SIDEDIM === _this.geoDomainDimension || _this.STACKDIM === _this.geoDomainDimension) &&\n          (Boolean(_this.model.entities.getFilteredEntities().length) || !_this.model.entities_side.skipFilter);\n      },\n      \"change:entities_side.show\": function(evt) {\n        if (!_this._readyOnce) return;\n\n        let doReturn = false;\n        let _entitiesSameDimWithSide = null;\n        utils.forEach(_this.model.marker.side._space, h => {\n          if (h.dim === _this.model.entities_side.dim && h._name !== _this.model.entities_side._name && h._name !== _this.model.entities_geodomain._name) {\n            _entitiesSameDimWithSide = h;\n          }\n        });\n        if (_entitiesSameDimWithSide) {\n          _this.model.entities.getFilteredEntities();\n          const showEntities = _this.model.entities_side.getFilteredEntities().filter(s => !_entitiesSameDimWithSide.isShown(s));\n          if (showEntities.length) {\n            _entitiesSameDimWithSide.showEntity(showEntities);\n            doReturn = true;\n          }\n        }\n        if (_this.SIDEDIM !== _this.model.entities_side.dim) {\n          doReturn = true;\n        }\n        if (doReturn) return;\n\n        _this._updateIndicators();\n        _this._updateSideTitles();\n\n        if (!_this.model._ready || !_this.frame) return;\n        if (_this.smallMultiples) {\n          utils.forEach(_this.stackKeys, (stackKey, i) => {\n            _this._updateLimits(stackKey, i);\n          });\n        } else {\n          _this._updateLimits();\n        }\n        _this.resize();\n        _this._updateEntities(true);\n        _this._redrawLocked();\n      },\n      \"change:entities_age.grouping\": function(evt) {\n        _this.groupBy = +_this.model.entities_age.grouping || 1;\n        _this.model.time.step = _this.groupBy;\n        _this.timeSteps = _this.model.time.getAllSteps();\n        _this.model.ui.chart.lockNonSelected = 0;\n        _this.labels.text(\"\");\n      },\n      \"change:ui.chart.inpercent\": function(evt) {\n        if (!_this._readyOnce) return;\n        if (_this.smallMultiples) {\n          utils.forEach(_this.stackKeys, (stackKey, i) => {\n            _this._updateLimits(stackKey, i);\n          });\n        } else {\n          _this._updateLimits();\n        }\n        _this.resize();\n        _this._updateEntities();\n        _this._redrawLocked();\n      },\n      \"change:ui.chart.flipSides\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this.model.marker.side.switchSideState();\n        _this._updateIndicators();\n        _this._updateSideTitles();\n        _this.resize();\n        _this._updateEntities(true);\n        _this._redrawLocked();\n      },\n      \"change:ui.chart.lockNonSelected\": function(evt) {\n        _this.lock = _this.model.ui.chart.lockNonSelected;\n        if (_this.lock) {\n          if (!(_this.stackKeys.length <= 1 || _this.stackSkip || _this.smallMultiples)) {\n            _this.model.ui.chart.lockNonSelected = 0;\n            return;\n          }\n          _this.yearLocked.text(\" \" + _this.lock);//\n          _this._makeOutlines(_this.frameAxisX, _this.total);\n        } else {\n          _this.yearLocked.text(\"\");\n          _this.lockedPaths.text(\"\");\n        }\n      },\n      \"ready:marker\": function(evt) {\n        if (!_this._readyOnce) return;\n        _this.updateStartEnd(_this.model.time.value, _this.groupBy);\n      }\n    };\n\n    //contructor is the same as any component\n    this._super(config, context);\n\n    this.textEllipsis = new TextEllipsis(this);\n\n    this.xScale = null;\n    this.yScale = null;\n    this.cScale = null;\n\n    this.xAxis = axisSmart(\"bottom\");\n    this.xAxisLeft = axisSmart(\"bottom\");\n    this.yAxis = axisSmart(\"left\");\n    this.xScales = [];\n    this.SHIFTEDAGEDIM = \"s_age\";\n\n  },\n\n  domReady() {\n    this._super();\n    ////replace code below when IE11 support will be skipped\n    // this.graphTemplate = d3.select(this.element)\n    //   .select(\".vzb-bc-graph\")\n    //   .html();\n    this.graphTemplate = new XMLSerializer().serializeToString(d3.select(this.element).select(\".vzb-bc-graph\").node());\n    ////\n  },\n\n  // afterPreload: function() {\n  //   var obj = {};\n  //   obj[\"which\"] = this.model.marker.axis_x.which;\n  //   obj[\"use\"] = this.model.marker.axis_x.use;\n  //   this.model.marker_side.hook_total.set(obj);\n  // },\n\n  updateStartEnd(time, groupBy) {\n    const timeModel = this.model.time;\n    const timeYear = timeModel.formatDate(time);\n    const startYear = +timeModel.formatDate(timeModel.start);\n    const offset = (+timeYear - startYear) % groupBy;\n    if (offset !== timeModel.offset) {\n      timeModel.set(\"offset\", offset, false, false);\n      this.timeSteps = timeModel.getAllSteps();\n      timeModel.set({\n        startSelected: new Date(this.timeSteps[0]),\n        endSelected: new Date(this.timeSteps[this.timeSteps.length - 1])\n      }, false, false);\n      return true;\n    }\n    return false;\n  },\n\n  getTimeOffset(timeModel, groupBy) {\n    const startYear = +timeModel.formatDate(timeModel.start);\n    const timeYear = +timeModel.formatDate(timeModel.value);\n    return (+timeYear - startYear) % groupBy;\n  },\n\n  checkDimensions() {\n    const stackDim = this.model.entities.dim;\n    const sideDim = this.model.entities_side.dim;\n\n    this.colorUseConstant = this.model.marker.color.use == \"constant\";\n    this.stackSkip = this.colorUseConstant || stackDim == sideDim;\n    this.geoLess = stackDim !== this.geoDomainDimension && sideDim !== this.geoDomainDimension;\n    this.sideSkip = this.model.marker.side.use == \"constant\";\n  },\n\n  /**\n   * DOM is ready\n   */\n  readyOnce() {\n    const _this = this;\n    this.el = (this.el) ? this.el : d3.select(this.element);\n    this.element = this.el;\n\n    this.textEllipsis.setTooltip(this.element.select(\".vzb-bc-tooltip\"));\n\n    this.interaction = this._interaction();\n\n    this.geoDomainDimension = this.model.entities_geodomain.getDimension();\n    this.geoDomainDefaultValue = this.model.entities_geodomain.show[this.geoDomainDimension][\"$in\"][0];\n\n    this.xTitleEl = this.element.select(\".vzb-bc-axis-x-title\");\n    this.xInfoEl = this.element.select(\".vzb-bc-axis-x-info\");\n    this.yearEl = this.element.select(\".vzb-bc-year-now\");\n    this.year = new DynamicBackground(this.yearEl); \n    this.year.setText(this.model.time.formatDate(this.model.time.value));\n    this.yearLocked = this.element.select(\".vzb-bc-year-locked\");\n\n    this.someSelected = (this.model.marker.select.length > 0);\n    this.nonSelectedOpacityZero = false;\n\n    this.groupBy = +this.model.entities_age.grouping || 1;\n\n    this.on(\"resize\", () => {\n      _this._updateEntities();\n      _this._redrawLocked();\n    });\n\n    this._attributeUpdaters = {\n      _newWidth(d, i) {\n        //d[\"x_\"] = 0;\n        let width;\n        if (_this.geoLess && _this.stackSkip && _this.sideSkip) {\n          width = (_this.frameAxisX[d[_this.AGEDIM] + _this.ageShift] || {})[_this.geoDomainDefaultValue];\n        } else if (_this.geoLess && _this.stackSkip) {\n          width = _this.colorUseConstant || d[_this.PREFIXEDSIDEDIM] == d[_this.PREFIXEDSTACKDIM] ? (_this.frameAxisX[d[_this.PREFIXEDSIDEDIM]][d[_this.AGEDIM] + _this.ageShift] || {})[_this.geoDomainDefaultValue] : 0;\n        } else if (_this.geoLess && _this.sideSkip) {\n          width = (_this.frameAxisX[d[_this.PREFIXEDSTACKDIM]][d[_this.AGEDIM] + _this.ageShift] || {})[_this.geoDomainDefaultValue];\n        } else if (_this.stackSkip) {\n          width = _this.colorUseConstant || d[_this.PREFIXEDSIDEDIM] == d[_this.PREFIXEDSTACKDIM] ? _this.frameAxisX[d[_this.PREFIXEDSIDEDIM]][d[_this.AGEDIM] + _this.ageShift] : 0;\n        } else if (_this.sideSkip) {\n          width = _this.frameAxisX[d[_this.PREFIXEDSTACKDIM]][d[_this.AGEDIM] + _this.ageShift];\n        } else {\n          width = _this.frameAxisX[d[_this.PREFIXEDSTACKDIM]][d[_this.PREFIXEDSIDEDIM]][d[_this.AGEDIM] + _this.ageShift];\n        }\n        d[\"width_\"] = width ? _this.xScale(width) : 0;\n        if (_this.ui.chart.inpercent) {\n          d[\"width_\"] /= _this.total[d.i][d[_this.PREFIXEDSIDEDIM]];\n        }\n        return d.width_;\n      },\n      _newX(d, i) {\n        const prevSbl = this.previousSibling;\n        if (prevSbl) {\n          const prevSblDatum = d3.select(prevSbl).datum();\n          d[\"x_\"] = prevSblDatum.x_ + prevSblDatum.width_;\n        }\n        // else {\n        //   d[\"x_\"] = 0;\n        // }\n        return d.x_;\n      }\n    };\n  },\n\n  /*\n   * Both model and DOM are ready\n   */\n  ready() {\n    //TODO: get component ready if some submodel doesn't ready ??????\n    if (!this.model.marker._ready) return;\n\n    const _this = this;\n\n    this.lock = _this.model.ui.chart.lockNonSelected;\n\n    this.timeSteps = this.model.time.getAllSteps();\n\n    this.shiftScale = d3.scaleLinear()\n      .domain([this.timeSteps[0], this.timeSteps[this.timeSteps.length - 1]])\n      .range([0, this.timeSteps.length - 1]);\n\n    this.domains = [];\n\n    this.SIDEDIM = this.model.entities_side.getDimension();\n    this.PREFIXEDSIDEDIM = \"side_\" + this.SIDEDIM;\n    this.STACKDIM = this.model.entities.getDimension();// || this.geoDomainDimension;//this.model.marker.color.which;\n    this.PREFIXEDSTACKDIM = \"stack_\" + this.STACKDIM;\n    this.AGEDIM = this.model.entities_age.getDimension();\n    this.TIMEDIM = this.model.time.getDimension();\n    this.checkDimensions();\n    this.updateUIStrings();\n    this._updateIndicators();\n    this.smallMultiples = (this.model.ui.chart || {}).mode === \"smallMultiples\" && !this.stackSkip && this.stackKeys.length > 1 ? true : false;\n    this._updateGraphs(this.smallMultiples ? this.stackKeys : [\"undefined\"]);\n    this._updateSideTitles();\n\n    if (this.lock && (this.stackKeys.length <= 1 || this.stackSkip || this.smallMultiples)) {\n      this.yearLocked.text(\"\" + this.lock);\n    } else {\n      _this.model.ui.chart.lockNonSelected = 0;\n    }\n    this.model.ui.chart.set(\"lockUnavailable\", !(this.stackKeys.length <= 1 || this.stackSkip || this.smallMultiples), false, false);\n\n    this.frame = null;\n    this.frameAllColor = {};\n\n    this.model.marker.getFrame(_this.model.time.value, (frame, time) => {\n      _this.frame = frame;\n      _this.frameAxisX = frame.axis_x;\n\n      const frames = {};\n      frames[time] = frame;\n      _this.maxLimits = {};\n      _this.inpercentMaxLimits = {};\n      _this.totals = {};\n\n      if (_this.smallMultiples) {\n        utils.forEach(_this.stackKeys, (stackKey, i) => {\n          _this._createLimits(frames, stackKey);\n          _this._updateLimits(stackKey, i);\n        });\n      } else {\n        _this._createLimits(frames);\n        _this._updateLimits();\n      }\n      _this._getLimits();\n\n      _this.resize();\n      _this.model.marker_allpossible.getFrame(_this.model.time.value, apFrame => {\n        _this.frameAllColor = apFrame.color || {};\n        _this._updateEntities(true);\n        _this.updateBarsOpacity();\n        //_this._redrawLocked();\n        //_this.model.time.set('value', _this.model.time.value, true, true);\n      });\n    });\n\n  },\n\n  _updateGraphs(data) {\n    const _this = this;\n    const graph = this.element.selectAll(\".vzb-bc-graph\").data(data)\n    graph.exit().remove();\n    ////replace code below when IE11 support will be skipped\n    //  graph.enter().append(\"g\")\n    //   .attr(\"class\", \"vzb-bc-graph\")\n    //   .html(this.graphTemplate);\n    graph.enter().append(function() {\n      return this.ownerDocument.importNode(\n        new DOMParser().parseFromString(_this.graphTemplate, 'application/xml').documentElement, true);\n    });\n    ////\n\n    this.element.select(\".vzb-bc-tooltip\").raise();\n    this.graph = this.element.selectAll(\".vzb-bc-graph\");\n    this.yAxisEl = this.graph.select(\".vzb-bc-axis-y\");\n    this.xAxisEl = this.graph.select(\".vzb-bc-axis-x\");\n    this.xAxisLeftEl = this.graph.select(\".vzb-bc-axis-x-left\");\n    this.yTitleEl = this.graph.select(\".vzb-bc-axis-y-title\");\n    this.title = this.graph.select(\".vzb-bc-title\");\n    this.titleRight = this.graph.select(\".vzb-bc-title-right\");\n    this.titleCenter = this.graph.select(\".vzb-bc-title-center\");\n    this.barsCrop = this.graph.select(\".vzb-bc-bars-crop\");\n    this.lockedCrop = this.graph.select(\".vzb-bc-locked-crop\");\n    this.labelsCrop = this.graph.select(\".vzb-bc-labels-crop\");\n    this.bars = this.barsCrop.select(\".vzb-bc-bars\");\n    this.lockedPaths = this.lockedCrop.select(\".vzb-bc-paths\");\n    this.labels = this.labelsCrop.select(\".vzb-bc-labels\");\n  },\n\n  _getLimits() {\n    const _this = this;\n    return function() {\n      const groupBy = _this.groupBy;\n      _this.model.marker.getFrame(null, frames => {\n        if(!frames || groupBy !== _this.groupBy) return;\n        if (_this.smallMultiples) {\n          utils.forEach(_this.stackKeys, (stackKey, i) => {\n            _this._createLimits(frames, stackKey);\n            _this._updateLimits(stackKey, i);            \n          });\n        } else {\n          _this._createLimits(frames);\n          _this._updateLimits();\n        }\n        _this.resize();\n        _this._updateEntities(true);\n        _this.updateBarsOpacity();\n        _this._redrawLocked();\n      });\n    }();\n  },\n\n  _redrawLocked() {\n    const _this = this;\n    if (!this.lock) return;\n\n    this.model.marker.getFrame(this.model.time.parse(\"\" + this.lock), (lockFrame, lockTime) => {\n      if (!lockFrame) return;\n      _this.lockedPaths.text(\"\");\n      let total = {};\n      if (this.ui.chart.inpercent) {\n        if (this.smallMultiples) {\n          utils.forEach(this.stackKeys, (stackKey, i) => {\n            total[i] = this.totals[stackKey][lockTime] ? this.totals[stackKey][lockTime] : this._interpolateBetweenTotals(this.timeSteps, this.totals[stackKey], lockTime);\n          });\n        } else {\n          total[0] = this.totals[lockTime] ? this.totals[lockTime] : this._interpolateBetweenTotals(this.timeSteps, this.totals, lockTime);\n        }\n        if (!total[0]) return;\n      }\n      _this._makeOutlines(lockFrame.axis_x, total);\n    });\n  },\n\n  interpolateDiagonal(pValues, nValues, fraction) {\n    const _this = this;\n    const dataBetweenFrames = {};\n    let data;\n    let val1, val2, shiftedAge;\n    const groupBy = this.groupBy;\n    if (this.geoLess && this.stackSkip && this.sideSkip) {\n      data = dataBetweenFrames;\n      utils.forEach(_this.ageKeys, age => {\n        shiftedAge = +age + groupBy;\n        val1 = pValues[age][_this.geoDomainDefaultValue];\n        val2 = (nValues[shiftedAge] || {})[_this.geoDomainDefaultValue] || 0;\n        data[shiftedAge] = {};\n        data[shiftedAge][_this.geoDomainDefaultValue] = (val1 == null || val2 == null) ? null : val1 + ((val2 - val1) * fraction);\n      });\n      data[0] = {};\n      data[0][_this.geoDomainDefaultValue] = nValues[0][_this.geoDomainDefaultValue] || 0;\n    } else if (this.stackSkip && this.geoLess) {\n      utils.forEach(_this.sideKeys, side => {\n        data = dataBetweenFrames[side] = {};\n        utils.forEach(_this.ageKeys, age => {\n          shiftedAge = +age + groupBy;\n          val1 = pValues[side][age][_this.geoDomainDefaultValue];\n          val2 = (nValues[side][shiftedAge] || {})[_this.geoDomainDefaultValue] || 0;\n          data[shiftedAge] = {};\n          data[shiftedAge][_this.geoDomainDefaultValue] = (val1 == null || val2 == null) ? null : val1 + ((val2 - val1) * fraction);\n        });\n        data[0] = {};\n        data[0][_this.geoDomainDefaultValue] = nValues[side][0][_this.geoDomainDefaultValue] || 0;\n      });\n    } else if (this.stackSkip) {\n      utils.forEach(_this.sideKeys, side => {\n        data = dataBetweenFrames[side] = {};\n        utils.forEach(_this.ageKeys, age => {\n          shiftedAge = +age + groupBy;\n          val1 = pValues[side][age];\n          val2 = nValues[side][shiftedAge] || 0;\n          data[shiftedAge] = (val1 == null || val2 == null) ? null : val1 + ((val2 - val1) * fraction);\n        });\n        data[0] = nValues[side][0] || 0;\n      });\n    } else if (this.sideSkip && this.geoLess) {\n      utils.forEach(_this.stackKeys, stack => {\n        data = dataBetweenFrames[stack] = {};\n        utils.forEach(_this.ageKeys, age => {\n          shiftedAge = +age + groupBy;\n          val1 = pValues[stack][age][_this.geoDomainDefaultValue];\n          val2 = (nValues[stack][shiftedAge] || {})[_this.geoDomainDefaultValue] || 0;\n          data[shiftedAge] = {};\n          data[shiftedAge][_this.geoDomainDefaultValue] = (val1 == null || val2 == null) ? null : val1 + ((val2 - val1) * fraction);\n        });\n        data[0] = {};\n        data[0][_this.geoDomainDefaultValue] = nValues[stack][0][_this.geoDomainDefaultValue] || 0;\n      });\n    } else if (this.sideSkip) {\n      utils.forEach(_this.stackKeys, stack => {\n        data = dataBetweenFrames[stack] = {};\n        utils.forEach(_this.ageKeys, age => {\n          shiftedAge = +age + groupBy;\n          val1 = pValues[stack][age];\n          val2 = nValues[stack][shiftedAge] || 0;\n          data[shiftedAge] = (val1 == null || val2 == null) ? null : val1 + ((val2 - val1) * fraction);\n        });\n        data[0] = nValues[stack][0] || 0;\n      });\n    } else {\n      utils.forEach(_this.stackKeys, stack => {\n        dataBetweenFrames[stack] = {};\n        utils.forEach(_this.sideKeys, side => {\n          data = dataBetweenFrames[stack][side] = {};\n          utils.forEach(_this.ageKeys, age => {\n            shiftedAge = +age + groupBy;\n            val1 = pValues[stack][side][age];\n            val2 = nValues[stack][side][shiftedAge] || 0;\n            data[shiftedAge] = (val1 == null || val2 == null) ? null : val1 + ((val2 - val1) * fraction);\n          });\n          data[0] = nValues[stack][side][0] || 0;\n        });\n      });\n    }\n    return dataBetweenFrames;\n  },\n\n  updateUIStrings() {\n    const _this = this;\n    this.translator = this.model.locale.getTFunction();\n\n    const xTitle = this.xTitleEl.selectAll(\"text\").data([0]);\n    xTitle.enter().append(\"text\")\n      .text(_this.translator(\"popbyage/title\"));\n\n    const conceptPropsX = this.model.marker.axis_x.getConceptprops();\n    utils.setIcon(this.xInfoEl, iconQuestion)\n      .select(\"svg\").attr(\"width\", \"0px\").attr(\"height\", \"0px\")\n      .style('opacity', Number(Boolean(conceptPropsX.description || conceptPropsX.sourceLink)));\n\n    this.xInfoEl.on(\"click\", () => {\n      _this.parent.findChildByName(\"gapminder-datanotes\").pin();\n    });\n    this.xInfoEl.on(\"mouseover\", function() {\n      if (_this.model.time.dragging) return;\n      const rect = this.getBBox();\n      const coord = utils.makeAbsoluteContext(this, this.farthestViewportElement)(rect.x - 10, rect.y + rect.height + 10);\n      const toolRect = _this.root.element.getBoundingClientRect();\n      const chartRect = _this.element.node().getBoundingClientRect();\n      _this.parent.findChildByName(\"gapminder-datanotes\").setHook(\"axis_x\").show().setPos(coord.x + chartRect.left - toolRect.left, coord.y);\n    });\n    this.xInfoEl.on(\"mouseout\", () => {\n      if (_this.model.time.dragging) return;\n    _this.parent.findChildByName(\"gapminder-datanotes\").hide();\n  });\n\n    // var titleStringY = this.model.marker.axis_y.getConceptprops().name;\n\n    // var yTitle = this.yTitleEl.selectAll(\"text\").data([0]);\n    // yTitle.enter().append(\"text\");\n    // yTitle\n    //   .attr(\"y\", \"-6px\")\n    //   .attr(\"x\", \"-9px\")\n    //   .attr(\"dx\", \"-0.72em\")\n    //   .text(titleStringY);\n  },\n\n  /**\n   * Changes labels for indicators\n   */\n  _updateIndicators() {\n    const _this = this;\n    this.duration = this.model.time.delayAnimations;\n    this.yScale = this.model.marker.axis_y.getScale();\n    this.xScale = this.model.marker.axis_x.getScale();\n    this.yAxis.tickFormat(_this.model.marker.axis_y.getTickFormatter());\n    this.xAxis.tickFormat(_this.model.marker.axis_x.getTickFormatter());\n    this.xAxisLeft.tickFormat(_this.model.marker.axis_x.getTickFormatter());\n\n    const sideDim = this.SIDEDIM;\n    const stackDim = this.STACKDIM;\n    const ageDim = this.AGEDIM;\n    const groupBy = this.groupBy;\n\n    const ages = this.model.marker.getKeys(ageDim);\n    let ageKeys = [];\n    ageKeys = ages.map(m => m[ageDim]);\n    this.ageKeys = ageKeys;\n\n    this.shiftedAgeKeys = this.timeSteps.map((m, i) => -i * groupBy).slice(1).reverse().concat(ageKeys);\n\n    this.sideItems = this.model.marker.label_side.getItems();\n    //var sideKeys = Object.keys(sideItems);\n    let sideKeys = [];\n    if (!utils.isEmpty(this.sideItems)) {\n      const sideFiltered = !!this.model.marker.side.getEntity().show[sideDim];\n      const sides = this.model.marker.getKeys(sideDim)\n          .filter(f => !sideFiltered || this.model.marker.side.getEntity().isShown(f));\n      sideKeys = sides.map(m => m[sideDim]);\n\n      if (sideKeys.length > 2) sideKeys.length = 2;\n      if (sideKeys.length > 1) {\n        const sortFunc = this.ui.chart.flipSides ? d3.ascending : d3.descending;\n        sideKeys.sort(sortFunc);\n      }\n    }\n    if (!sideKeys.length) sideKeys.push(\"undefined\");\n    this.sideKeys = sideKeys;\n\n    const stacks = this.model.marker.getKeys(stackDim);\n    const stackKeys = stacks.map(m => m[stackDim]);\n\n    let sortedStackKeys = utils.keys(this.model.marker.color.getPalette()).reduce((arr, val) => {\n        if (stackKeys.indexOf(val) != -1) arr.push(val);\n        return arr;\n      }, []);\n\n    if (sortedStackKeys.length != stackKeys.length) {\n      sortedStackKeys = stackKeys.reduce((arr, val) => {\n          if (arr.indexOf(val) == -1) arr.push(val);\n          return arr;\n        }, sortedStackKeys);\n    }\n    this.stackKeys = sortedStackKeys;\n    this.stackItems = this.model.marker.label_stack.getItems();\n\n    this.stacked = this.ui.chart.stacked && this.model.marker.color.use != \"constant\" && this.model.entities.getDimension();\n\n    this.twoSided = this.sideKeys.length > 1;\n    if (this.twoSided) {\n      this.xScaleLeft = this.xScale.copy();\n    }\n\n    this.cScale = this.model.marker.color.getScale();\n\n    this.markers = this.model.marker.getKeys(ageDim);\n  },\n\n  _updateSideTitles() {\n    const _this = this;\n    const sideItems = this.sideItems;\n    \n    this.titleRight.classed(\"vzb-hidden\", !this.twoSided);\n    if (this.twoSided) {\n      this.title.text(sideItems[this.sideKeys[1]]).call(this.textEllipsis.clear);\n      this.titleRight.text(sideItems[this.sideKeys[0]]).call(this.textEllipsis.clear);;\n    } else {\n      const title = this.sideKeys.length && sideItems[this.sideKeys[0]] ? sideItems[this.sideKeys[0]] : \"\";\n      this.title.text(title).call(this.textEllipsis.clear);;\n    }\n\n    if (this.smallMultiples) {\n      this.titleCenter.call(this.textEllipsis.clear).each(function(d, i) {\n        d3.select(this).text(_this.stackItems[_this.stackKeys[i]]);\n      });\n    } else {\n      const title = this.stackKeys.length && this.stackItems[this.stackKeys[0]] ? this.stackItems[this.stackKeys[0]] : \"\";\n      this.titleCenter.text(title).call(this.textEllipsis.clear);\n    }\n  },\n\n  _createLimits(frames, stackKey) {\n    const _this = this;\n\n    const stackKeys = stackKey ? [stackKey] : this.stackKeys;  \n    //const sideKeysNF = Object.keys(this.model.marker.side.getItems());\n    const sideKeysNF = Object.keys(this.model.marker.side.getNestedItems([this.SIDEDIM]));\n    if (!sideKeysNF.length) sideKeysNF.push(\"undefined\");\n\n    const totals = {};\n    const inpercentMaxLimits = {};\n    const maxLimits = {};\n    const geoLess = this.geoLess;\n    const geoDefault = this.geoDomainDefaultValue;\n    sideKeysNF.forEach(s => {\n      maxLimits[s] = [];\n      inpercentMaxLimits[s] = [];\n    });\n\n    if (_this.stackSkip && _this.sideSkip) {\n      utils.forEach(frames, (f, time) => {\n        const frame = f.axis_x;\n        totals[time] = {};\n        let ageSum = 0;\n        const sideMaxLimits = [];\n        utils.forEach(_this.ageKeys, age => {\n          let stackSum = 0;\n          if (frame[age]) {\n            stackSum += frame[age][geoDefault];\n            ageSum += stackSum;\n          }\n          sideMaxLimits.push(stackSum);\n        });\n        totals[time][sideKeysNF[0]] = ageSum;\n        const maxSideLimit = Math.max(...sideMaxLimits);\n        inpercentMaxLimits[sideKeysNF[0]].push(maxSideLimit / ageSum);\n        maxLimits[sideKeysNF[0]].push(maxSideLimit);\n      });\n    } else if (_this.sideSkip) {\n      utils.forEach(frames, (f, time) => {\n        const frame = f.axis_x;\n        totals[time] = {};\n        let ageSum = 0;\n        const sideMaxLimits = [];\n        utils.forEach(_this.ageKeys, age => {\n          let stackSum = 0;\n          utils.forEach(stackKeys, stack => {\n            if (frame[stack] && frame[stack][age]) {\n              stackSum += geoLess ? frame[stack][age][geoDefault] : frame[stack][age];\n              ageSum += stackSum;\n            }\n          });\n          sideMaxLimits.push(stackSum);\n        });\n        totals[time][sideKeysNF[0]] = ageSum;\n        const maxSideLimit = Math.max(...sideMaxLimits);\n        inpercentMaxLimits[sideKeysNF[0]].push(maxSideLimit / ageSum);\n        maxLimits[sideKeysNF[0]].push(maxSideLimit);\n      });\n    } else if (_this.stackSkip) {\n      utils.forEach(frames, (f, time) => {\n        const frame = f.axis_x;\n        totals[time] = {};\n        utils.forEach(sideKeysNF, side => {\n          let ageSum = 0;\n          const sideMaxLimits = [];\n          utils.forEach(_this.ageKeys, age => {\n            let stackSum = 0;\n            if (frame[side] && frame[side][age]) {\n              stackSum += geoLess ? frame[side][age][geoDefault] : frame[side][age];\n              ageSum += stackSum;\n            }\n            sideMaxLimits.push(stackSum);\n          });\n          totals[time][side] = ageSum;\n          const maxSideLimit = Math.max(...sideMaxLimits);\n          inpercentMaxLimits[side].push(maxSideLimit / ageSum);\n          maxLimits[side].push(maxSideLimit);\n        });\n      });\n    } else {\n      utils.forEach(frames, (f, time) => {\n        const frame = f.axis_x;\n        totals[time] = {};\n        utils.forEach(sideKeysNF, side => {\n          let ageSum = 0;\n          const sideMaxLimits = [];\n          utils.forEach(_this.ageKeys, age => {\n            let stackSum = 0;\n            utils.forEach(stackKeys, stack => {\n              if (frame[stack][side] && frame[stack][side][age]) {\n                stackSum += geoLess ? frame[stack][side][age][geoDefault] : frame[stack][side][age];\n                ageSum += stackSum;\n              }\n            });\n            sideMaxLimits.push(stackSum);\n          });\n          totals[time][side] = ageSum;\n          const maxSideLimit = Math.max(...sideMaxLimits);\n          inpercentMaxLimits[side].push(maxSideLimit / ageSum);\n          maxLimits[side].push(maxSideLimit);\n        });\n      });\n    }\n\n    if (stackKey) {\n      this.maxLimits[stackKey] = {};\n      this.inpercentMaxLimits[stackKey] = {};\n      sideKeysNF.forEach(s => {\n        _this.maxLimits[stackKey][s] = Math.max(...maxLimits[s]);\n        _this.inpercentMaxLimits[stackKey][s] = Math.max(...inpercentMaxLimits[s]);\n      });\n      this.totals[stackKey] = totals;\n    } else {\n      sideKeysNF.forEach(s => {\n        _this.maxLimits[s] = Math.max(...maxLimits[s]);\n        _this.inpercentMaxLimits[s] = Math.max(...inpercentMaxLimits[s]);\n      });\n      this.totals = totals;\n    }\n  },\n\n  _updateLimits(stackKey, i) {\n    const _this = this;\n    const axisX = this.model.marker.axis_x;\n    if (this.smallMultiples && stackKey) {\n      if (this.ui.chart.inpercent) {\n        this.domains[i] = [0, Math.max(...this.sideKeys.map(s => _this.inpercentMaxLimits[stackKey][s]))];\n      } else {\n        this.domains[i] = (axisX.domainMin != null && axisX.domainMax != null) ? [+axisX.domainMin, +axisX.domainMax] : [0, Math.max(...this.sideKeys.map(s => _this.maxLimits[stackKey][s]))];\n      }\n    } else {\n      if (this.ui.chart.inpercent) {\n        this.domains[0] = [0, Math.max(...this.sideKeys.map(s => _this.inpercentMaxLimits[s]))];\n      } else {\n        this.domains[0] = (axisX.domainMin != null && axisX.domainMax != null) ? [+axisX.domainMin, +axisX.domainMax] : [0, Math.max(...this.sideKeys.map(s => _this.maxLimits[s]))];\n      }\n    }\n\n    this.xScale.domain(this.domains[0]);\n    if (this.xScaleLeft) this.xScaleLeft.domain(this.xScale.domain());\n\n    this.domainScalers = this._calcDomainScalers();\n  },\n\n  _calcDomainScalers() {\n    const domain = this.domains.map(m => m[1] - m[0])\n    const sumDomains = domain.reduce((a, b) => a + b);\n    return domain.map(d => d / sumDomains);\n  },\n\n  _interpolateBetweenTotals(timeSteps, totals, time) {\n    const nextStep = d3.bisectLeft(timeSteps, time);\n    const fraction = (time - timeSteps[nextStep - 1]) / (timeSteps[nextStep] - timeSteps[nextStep - 1]);\n    const total = {};\n    utils.forEach(this.sideKeys, side => {\n      total[side] = totals[timeSteps[nextStep]][side] * fraction + totals[timeSteps[nextStep - 1]][side] * (1 - fraction);\n  });\n    return total;\n  },\n\n  /**\n   * Updates entities\n   */\n  _updateEntities(reorder) {\n\n    const _this = this;\n    const time = this.model.time;\n    const sideDim = this.SIDEDIM;\n    const prefixedSideDim = this.PREFIXEDSIDEDIM;\n    const ageDim = this.AGEDIM;\n    const stackDim = this.STACKDIM;\n    const prefixedStackDim = this.PREFIXEDSTACKDIM;\n    const timeDim = this.TIMEDIM;\n    const duration = (time.playing) ? time.delayAnimations : 0;\n    let total;\n\n    const groupBy = this.groupBy;\n    //var group_offset = this.model.marker.group_offset ? Math.abs(this.model.marker.group_offset % groupBy) : 0;\n\n    if (this.ui.chart.inpercent) {\n      this.total = {};\n      if (this.smallMultiples) {\n        utils.forEach(this.stackKeys, (stackKey, i) => {\n          this.total[i] = this.totals[stackKey][time.value] ? this.totals[stackKey][time.value] : this._interpolateBetweenTotals(this.timeSteps, this.totals[stackKey], time.value);\n        });\n      } else {\n        this.total[0] = this.totals[time.value] ? this.totals[time.value] : this._interpolateBetweenTotals(this.timeSteps, this.totals, time.value);\n      }\n    }\n\n    const domain = this.yScale.domain();\n\n    //this.model.age.setVisible(markers);\n\n    const nextStep = d3.bisectLeft(this.timeSteps, time.value);\n\n    const shiftedAgeDim = this.SHIFTEDAGEDIM;\n\n    const markers = this.markers.map(data => {\n        const o = {};\n    o[ageDim] = o[shiftedAgeDim] = +data[ageDim];\n    o[ageDim] -= nextStep * groupBy;\n    return o;\n  });\n\n    const ageData = markers.slice(0);\n\n    const outAge = {};\n    outAge[shiftedAgeDim] = markers.length * groupBy;\n    outAge[ageDim] = outAge[shiftedAgeDim] - nextStep * groupBy;\n\n    this.ageShift = nextStep * groupBy;\n\n    if (nextStep) ageData.push(outAge);\n\n    const stacks = _this.stacked ? _this.stackKeys : [_this.geoDomainDefaultValue];\n    const geoDomainDefaultValue = this.geoDomainDefaultValue;\n    const geoDomainDimension = this.geoDomainDimension;\n\n    // for(let i = 0, j = ageData.length; i < j; i++) {\n    //   const d = ageData[i];\n    //   d[\"side\"] = _this.sideKeys.map(m => {\n    //     const r = {};\n    //     r[ageDim] = d[ageDim];\n    //     r[shiftedAgeDim] = d[shiftedAgeDim];\n    //     r[prefixedSideDim] = m;\n    //     r[sideDim] = m;\n    //     r[\"stack\"] = stacks.map(m => {\n    //       const s = {};\n    //       s[geoDomainDimension] = geoDomainDefaultValue;\n    //       s[ageDim] = r[ageDim];\n    //       s[shiftedAgeDim] = r[shiftedAgeDim];\n    //       s[sideDim] = r[sideDim];\n    //       s[stackDim] = m;\n    //       s[prefixedSideDim] = r[prefixedSideDim];\n    //       s[prefixedStackDim] = m;\n    //       s[\"x_\"] = 0;\n    //       s[\"width_\"] = 0;\n    //       return s;\n    //     });\n    //     return r;\n    //   });\n    // }\n\n    //this.barsData = ageData;\n    this.barsData = [];\n    let ageBars = this.bars.selectAll(\".vzb-bc-bar\")\n      .data((d, i) => (_this.barsData[i] = ageData.map(m => {\n        const p = {};\n        p[ageDim] = m[ageDim];\n        p[shiftedAgeDim] = m[shiftedAgeDim];    \n        p.i = i;\n        return p;\n      }), this.barsData[i]), d => d[ageDim]);\n    //exit selection\n    ageBars.exit().remove();\n\n    const oneBarHeight = this.oneBarHeight;\n    const barHeight = this.barHeight;\n    const firstBarOffsetY = this.firstBarOffsetY;\n\n    //enter selection -- init bars\n    ageBars = ageBars.enter().append(\"g\")\n      .attr(\"class\", d => \"vzb-bc-bar \" + \"vzb-bc-bar-\" + d[ageDim])\n      .attr(\"transform\", (d, i) => \"translate(0,\" + (firstBarOffsetY - (d[shiftedAgeDim] - domain[0] - groupBy) * oneBarHeight) + \")\")\n      .merge(ageBars);\n\n    // this.ageBars.attr(\"class\", function(d) {\n    //     return \"vzb-bc-bar \" + \"vzb-bc-bar-\" + d[ageDim];\n    //   })\n\n\n    let sideBars = ageBars.selectAll(\".vzb-bc-side\").data((d, i) => (d.side = _this.sideKeys.map(m => {\n      const r = {};\n      r[ageDim] = d[ageDim];\n      r[shiftedAgeDim] = d[shiftedAgeDim];\n      r[prefixedSideDim] = m;\n      r[sideDim] = m;\n      r.i = d.i;\n      return r;\n    }), d.side), d => d[prefixedSideDim]);\n\n    sideBars.exit().remove();\n    sideBars = sideBars.enter().append(\"g\")\n      .attr(\"class\", (d, i) => \"vzb-bc-side \" + \"vzb-bc-side-\" + (!i != !_this.twoSided ? \"right\" : \"left\"))\n      .attr(\"transform\", (d, i) => i ? (\"scale(-1,1) translate(\" + _this.activeProfile.centerWidth + \",0)\") : \"\")\n      .merge(sideBars);\n\n    if (reorder) {\n      sideBars\n        .attr(\"class\", (d, i) => \"vzb-bc-side \" + \"vzb-bc-side-\" + (!i != !_this.twoSided ? \"right\" : \"left\"))\n        .attr(\"transform\", (d, i) => i ? (\"scale(-1,1) translate(\" + _this.activeProfile.centerWidth + \",0)\") : \"\");\n    }\n\n    const _attributeUpdaters = this._attributeUpdaters;\n\n    let stackBars = sideBars.selectAll(\".vzb-bc-stack\").data(d => ( d.stack = (_this.smallMultiples ? [stacks[d.i]] : stacks).map(m => {\n      const s = {};\n      s[geoDomainDimension] = geoDomainDefaultValue;\n      s[ageDim] = d[ageDim];\n      s[shiftedAgeDim] = d[shiftedAgeDim];\n      s[sideDim] = d[sideDim];\n      s[stackDim] = m;\n      s[prefixedSideDim] = d[prefixedSideDim];\n      s[prefixedStackDim] = m;\n      s[\"x_\"] = 0;\n      s[\"width_\"] = 0;\n      s.i = d.i;\n      return s;\n    }), d.stack), d => d[prefixedStackDim]);\n\n    stackBars.exit().remove();\n    stackBars = stackBars.enter().append(\"rect\")\n      .attr(\"class\", (d, i) => \"vzb-bc-stack \" + \"vzb-bc-stack-\" + i + (_this.highlighted ? \" vzb-dimmed\" : \"\"))\n      .attr(\"y\", 0)\n      .attr(\"height\", barHeight - (groupBy > 2 ? 1 : 0))\n      .attr(\"fill\", d => _this.cScale(_this.frameAllColor[d[prefixedStackDim]] || d[prefixedStackDim]))\n      //.attr(\"width\", _attributeUpdaters._newWidth)\n      .attr(\"x\", _attributeUpdaters._newX)\n      .on(\"mouseover\", _this.interaction.mouseover)\n      .on(\"mouseout\", _this.interaction.mouseout)\n      .on(\"click\", _this.interaction.click)\n      .onTap(_this.interaction.tap)\n      .merge(stackBars);\n\n\n    if (reorder) stackBars\n      .attr(\"class\", (d, i) => \"vzb-bc-stack \" + \"vzb-bc-stack-\" + i + (_this.highlighted ? \" vzb-dimmed\" : \"\"))\n      .attr(\"fill\", d => _this.cScale(_this.frameAllColor[d[prefixedStackDim]] || d[prefixedStackDim]))\n      .order();\n\n    const stepShift = (ageData[0][shiftedAgeDim] - ageData[0][ageDim]) - this.shiftScale(time.value) * groupBy;\n\n    if (duration) {\n      const transition = d3.transition()\n        .duration(duration)\n        .ease(d3.easeLinear);\n\n      ageBars\n        .transition(transition)\n        .attr(\"transform\", (d, i) => \"translate(0,\" + (firstBarOffsetY - (d[shiftedAgeDim] - domain[0] - stepShift) * oneBarHeight) + \")\");\n      stackBars\n        .transition(transition)\n        .attr(\"width\", _attributeUpdaters._newWidth)\n        .attr(\"x\", _attributeUpdaters._newX);\n    } else {\n      ageBars.interrupt()\n        .attr(\"transform\", (d, i) => \"translate(0,\" + (firstBarOffsetY - (d[shiftedAgeDim] - domain[0] - stepShift) * oneBarHeight) + \")\");\n      stackBars.interrupt()\n        .attr(\"width\", _attributeUpdaters._newWidth)\n        .attr(\"x\", _attributeUpdaters._newX);\n    }\n\n    this.ageBars = ageBars;\n    this.sideBars = sideBars;\n    this.stackBars = stackBars;\n\n    this.entityLabels = this.labels.selectAll(\".vzb-bc-label text\")\n      .data(markers);\n    //exit selection\n    this.entityLabels.exit().remove();\n\n    this.entityLabels = this.entityLabels.enter().append(\"g\")\n      .attr(\"class\", d => \"vzb-bc-label\" + \" vzb-bc-label-\" + d[shiftedAgeDim])\n      .append(\"text\")\n      .attr(\"class\", \"vzb-bc-age\")\n      .merge(this.entityLabels)\n      .each((d, i) => {\n        const yearOlds = _this.translator(\"popbyage/yearOlds\");\n\n        let age = parseInt(d[shiftedAgeDim], 10);\n\n        if (groupBy > 1) {\n          const nextAge = (age + groupBy - 1);\n          age = age + \"-to-\" + (nextAge > domain[1] ? domain[1] : nextAge);\n        }\n\n        d[\"text\"] = age + yearOlds;\n      })\n      .attr(\"y\", (d, i) => firstBarOffsetY - (d[shiftedAgeDim] - domain[0]) * oneBarHeight - 10)\n      .attr(\"dy\", (d, i) => (d[shiftedAgeDim] + groupBy) > domain[1] ? (groupBy - domain[1] + d[shiftedAgeDim]) / groupBy * barHeight : 0);\n    // .style(\"fill\", function(d) {\n    //   var color = _this.cScale(values.color[d[ageDim]]);\n    //   return d3.rgb(color).darker(2);\n    // });\n\n    this.year.setText(this.model.time.formatDate(time.value), this.duration);\n  },\n\n  _makeOutlines(frame, total) {\n    const _this = this;\n\n    const KEYS = utils.unique(this.model.marker._getAllDimensions({ exceptType: \"time\" }))\n    KEYS.forEach((key, i) => {\n        if (key === _this.AGEDIM) KEYS[i] = _this.SHIFTEDAGEDIM;\n        //if (_this.geoLess)\n      });\n\n    const groupBy = this.groupBy;\n    const barHeight = this.barHeight;\n    const firstBarOffsetY = this.firstBarOffsetY + barHeight;\n\n    const line = d3.line().curve(d3.curveStepBefore)\n      .x(d => d.x)//_ + d.width_)\n      .y((d, i) => firstBarOffsetY - barHeight * i  - (groupBy > 2 ? 1 : 0));\n\n    \n    const pathsData = this.barsData.map((barsData, _i) => {\n      const stackIndex = [0, 0];\n\n      return this.sideKeys.map((s, i) => {\n        if (_this.stackSkip) {\n          barsData[0].side[i].stack.forEach((d, j) => {\n            if (d[_this.PREFIXEDSIDEDIM] === d[_this.PREFIXEDSTACKDIM]) {\n              stackIndex[i] = j;\n            }\n          });\n        }\n        const data = {};\n        data.d = barsData.map(age => {\n          const r = {};\n          const x = utils.getValueMD(age.side[i].stack[stackIndex[i]], frame, KEYS);\n          r.x = x ? _this.xScale(x) : 0;\n            if (_this.ui.chart.inpercent) {\n              r.x /= total[_i][age.side[i].stack[stackIndex[i]][_this.PREFIXEDSIDEDIM]];\n            }\n          return r;\n        });\n        return data;\n      });\n    });\n\n    const data = this.bars.selectAll(\".vzb-bc-side-left\").selectAll(\".vzb-bc-stack-0\").data();\n    const color = _this.cScale(data[0][this.PREFIXEDSTACKDIM])\n    const colorShade = this.model.marker.color.getColorShade({\n      colorID: _this.frameAllColor[data[0][this.PREFIXEDSTACKDIM]] || data[0][this.PREFIXEDSTACKDIM],\n      shadeID: \"shade\"\n    }) || \"#000\";//d3.hsl(color).darker(2);\n\n    this.lockedPaths.each(function(d, _i) {\n      const paths = d3.select(this).selectAll(\"path\").data(pathsData[_i]);\n      paths.exit().remove();\n      paths.enter()\n        .append(\"path\")\n        .merge(paths)\n        .attr(\"d\", (d, i) => line(d.d))\n        .attr(\"stroke\", \"#000\")//colorShade)\n        .attr(\"transform\", (d, i) => i ? (\"scale(-1,1) translate(\" + _this.activeProfile.centerWidth + \",0)\") : \"\");\n    });\n  },\n\n  _setYear(timeValue) {\n    const formattedTime = this.model.time.formatDate(timeValue);\n    return function() { d3.select(this).text(formattedTime); };\n  },\n\n  _interaction() {\n    const _this = this;\n    return {\n      mouseover(d, i) {\n        if (utils.isTouchDevice()) return;\n        _this.model.marker.highlightMarker(d);\n        _this._showLabel(d);\n      },\n      mouseout(d, i) {\n        if (utils.isTouchDevice()) return;\n        _this.model.marker.clearHighlighted();\n      },\n      click(d, i) {\n        if (utils.isTouchDevice()) return;\n        _this.model.marker.selectMarker(d);\n      },\n      tap(d) {\n        d3.event.stopPropagation();\n        _this.model.marker.selectMarker(d);\n      }\n    };\n  },\n\n  _highlightBars(d) {\n    const _this = this;\n\n    _this.someHighlighted = (_this.model.marker.highlight.length > 0);\n\n    _this.updateBarsOpacity();\n\n    if (!_this.someHighlighted) {\n      //hide labels\n      _this.labels.selectAll(\".vzb-hovered\").classed(\"vzb-hovered\", false);\n    }\n  },\n\n  _showLabel(d) {\n    const _this = this;\n    const formatter = _this.ui.chart.inpercent ? d3.format(\".1%\") : _this.model.marker.axis_x.getTickFormatter();\n    const sideDim = _this.SIDEDIM;\n    const ageDim = _this.AGEDIM;\n    const stackDim = _this.STACKDIM;\n    const shiftedAgeDim = \"s_age\";\n    const left = _this.sideKeys.indexOf(d[sideDim]) > 0;\n\n    let deltaX = 7;\n    if (!this.smallMultiples) {\n      const hoverBarEl = d3.select(d3.event.target);\n      deltaX += +hoverBarEl.attr(\"x\");\n    }\n\n    const labelNode = _this.labels.select(\".vzb-bc-label-\" + d[shiftedAgeDim]).nodes()[d.i];// + \"-\" + _this._id);\n    const labelEl = d3.select(labelNode);\n    labelEl.selectAll(\".vzb-bc-age\")\n      .text(textData => {\n        //var total = _this.ui.chart.inpercent ? _this.totalValues[d[sideDim]] : 1;\n        let text = _this.stackKeys.length > 1 ? _this.stackItems[d[stackDim]] : textData.text;\n        text = _this.twoSided ? text : textData.text + \" \" + _this.stackItems[d[stackDim]];\n        const value = _this.xScale.invert(d[\"width_\"]);\n        return text + \": \" + formatter(value);\n      })\n      .attr(\"x\", left ? -this.activeProfile.centerWidth - deltaX : deltaX)\n      .attr(\"dx\", 0)\n      .classed(\"vzb-text-left\", left);\n    labelEl.classed(\"vzb-prehovered\", true);      \n    const bbox = labelNode.getBBox();\n    const transform = _this.element.node().getScreenCTM().inverse().multiply(labelNode.getScreenCTM());\n    const overDrawLeft = Math.max(-bbox.x - transform.e, 0);\n    const overDrawRight = Math.min(_this.fullWidth - bbox.x - bbox.width - transform.e, 0);\n    labelEl.selectAll(\".vzb-bc-age\").attr(\"dx\", overDrawLeft + overDrawRight);\n    labelEl.classed(\"vzb-prehovered\", false);\n    labelEl.classed(\"vzb-hovered\", true);\n  },\n\n  getGraphWidth(width, marginBetween) {\n    let _width = width || this.width;\n    if (this.smallMultiples) {\n      const length = this.graph.data().length;\n      _width -= marginBetween * (length - 1);\n      return this.domainScalers.map(scaler => _width * scaler);\n    } else {\n      return [_width];\n    }\n  },\n\n  getYAxisVisibility(index) {\n    return index == 0 ? true : false;\n  },\n\n  /**\n   * Executes everytime the container or vizabi is resized\n   * Ideally,it contains only operations related to size\n   */\n\n\n  presentationProfileChanges: {\n    medium: {\n      margin: { top: 120, right: 50, left:80, bottom: 60, between: 30 },\n      infoElHeight: 32\n    },\n    large: {\n      margin: { top: 120, right: 70, left: 100, bottom: 70, between: 30 },\n      infoElHeight: 32\n    }\n  },\n\n  profiles: {\n    \"small\": {\n      margin: {\n        top: 50,\n        right: 20,\n        left: 40,\n        bottom: 20,\n        between: 10\n      },\n      infoElHeight: 16,\n      centerWidth: 2,\n      titlesSpacing: 5\n    },\n    \"medium\": {\n      margin: {\n        top: 70,\n        right: 40,\n        left: 60,\n        bottom: 20,\n        between: 20\n      },\n      infoElHeight: 20,\n      centerWidth: 2,\n      titlesSpacing: 10\n    },\n    \"large\": {\n      margin: {\n        top: 80,\n        right: 60,\n        left: 60,\n        bottom: 30,\n        between: 20\n      },\n      infoElHeight: 22,\n      centerWidth: 2,\n      titlesSpacing: 20\n    }\n  },\n\n  resize() {\n    const _this = this;\n\n    this.activeProfile = this.getActiveProfile(this.profiles, this.presentationProfileChanges);\n\n    //this.activeProfile = this.profiles[this.getLayoutProfile()];\n    const margin = this.activeProfile.margin;\n    const infoElHeight = this.activeProfile.infoElHeight;\n\n    const deltaMarginTop = this.sideSkip ? margin.top * 0.23 : 0;\n    //stage\n    this.height = (parseInt(this.element.style(\"height\"), 10) + deltaMarginTop - margin.top - margin.bottom) || 0;\n    this.width = (parseInt(this.element.style(\"width\"), 10) - margin.left - margin.right) || 0;\n    this.fullWidth = parseInt(this.element.style(\"width\"), 10) || 0;\n    this.graphWidth = this.getGraphWidth(this.width, margin.between);\n\n    if (this.height <= 0 || this.width <= 0) return utils.warn(\"Pop by age resize() abort: vizabi container is too little or has display:none\");\n\n    let _sum = 0;\n    let _prevSum = 0;\n    const graphWidthSum = this.graphWidth.map(width => {_prevSum = _sum; _sum += width; return _prevSum;});\n    this.graph\n      .attr(\"transform\", (d, i) => \"translate(\" + Math.round(margin.left + margin.between * i + graphWidthSum[i]) + \",\" + (margin.top - deltaMarginTop) + \")\");\n\n    this.barsCrop\n      .attr(\"width\", (d, i) => this.graphWidth[i])\n      .attr(\"height\", Math.max(0, this.height));\n\n    this.lockedCrop\n      .attr(\"width\", (d, i) => this.graphWidth[i])\n      .attr(\"height\", Math.max(0, this.height));\n\n    this.labelsCrop\n      .attr(\"width\", (d, i) => this.graphWidth[i])\n      .attr(\"height\", Math.max(0, this.height));\n\n    const groupBy = this.groupBy;\n\n    const domain = this.yScale.domain();\n    this.oneBarHeight = this.height / (domain[1] - domain[0]);\n    const barHeight = this.barHeight = this.oneBarHeight * groupBy; // height per bar is total domain height divided by the number of possible markers in the domain\n    this.firstBarOffsetY = this.height - this.barHeight;\n\n    if (this.stackBars) this.stackBars.attr(\"height\", barHeight - (groupBy > 2 ? 1 : 0));\n\n    if (this.sideBars) this.sideBars\n      .attr(\"transform\", (d, i) => i ? (\"scale(-1,1) translate(\" + _this.activeProfile.centerWidth + \",0)\") : \"\");\n\n\n    //update scales to the new range\n    //apply scales to axes and redraw\n    this.yScale.range([this.height, 0]);\n\n    const yScaleCopy = this.yScale.copy();\n    if (groupBy > 2) {\n      yScaleCopy.ticks = () => d3.range(domain[0], domain[1] + 1, groupBy);\n    }\n\n    this.yAxisEl.each(function(d, i) {\n      _this.yAxis.scale(yScaleCopy.range([_this.height, 0]))\n        .tickSizeInner(-_this.graphWidth[i])\n        .tickSizeOuter(0)\n        .tickPadding(6)\n        .tickSizeMinor(-_this.graphWidth[i], 0)\n        .labelerOptions({\n          scaleType: _this.model.marker.axis_y.scaleType,\n          toolMargin: margin,\n          limitMaxTickNumber: 19,\n          fitIntoScale: \"optimistic\",\n          isPivotAuto: false\n        });\n      \n      d3.select(this).attr(\"transform\", \"translate(\" + 0 + \",0)\")\n        .call(_this.yAxis)\n        .classed(\"vzb-bc-axis-text-hidden\", !_this.getYAxisVisibility(i));\n    });\n    this.yAxisEl.select(\".tick line\").classed(\"vzb-hidden\", true);\n\n    const maxRange = _this.twoSided ? ((_this.graphWidth[0] - _this.activeProfile.centerWidth) * 0.5) : _this.graphWidth[0];\n    this.xScale.range([0, maxRange]);\n\n    const format = this.ui.chart.inpercent ? d3.format((groupBy > 3 ? \".1\" : \".1\") + \"%\") : this.model.marker.axis_x.getTickFormatter();\n\n    const translateX = [];\n    this.xAxisEl.each(function(d, i) {\n      const maxRange = _this.twoSided ? ((_this.graphWidth[i] - _this.activeProfile.centerWidth) * 0.5) : _this.graphWidth[i];\n      translateX[i] = _this.twoSided ? ((_this.graphWidth[i] + _this.activeProfile.centerWidth) * 0.5) : 0;\n\n      _this.xAxis.scale(_this.xScale.copy().domain(_this.domains[i]).range([0, maxRange]))\n        .tickFormat(format)\n        .tickSizeInner(-_this.height)\n        .tickSizeOuter(0)\n        .tickPadding(6)\n        .tickSizeMinor(-_this.height, 0)\n        .labelerOptions({\n          scaleType: _this.model.marker.axis_x.scaleType,\n          toolMargin: margin,\n          limitMaxTickNumber: 6\n        });\n\n      d3.select(this)\n        .attr(\"transform\", \"translate(\" + translateX[i] + \",\" + _this.height + \")\")\n        .call(_this.xAxis);\n      const zeroTickEl = d3.select(this).selectAll(\".tick text\");\n      const tickCount = zeroTickEl.size();\n      if (tickCount > 0) {\n        const zeroTickBBox = zeroTickEl.node().getBBox();\n        if (tickCount > 1) {\n          d3.select(zeroTickEl.node()).attr(\"dx\", (_this.twoSided ? -_this.activeProfile.centerWidth * 0.5 : 0) - zeroTickBBox.width * 0.5 - zeroTickBBox.x);\n        }\n        zeroTickEl.classed(\"vzb-invisible\", (_this.graphWidth[i] + margin.between) < zeroTickBBox.width);\n      }\n    });\n\n    this.xAxisEl.select(\".tick line\").classed(\"vzb-hidden\", true);\n    this.xAxisLeftEl.classed(\"vzb-hidden\", !this.twoSided);\n    if (this.twoSided) {\n      this.xScaleLeft.range([(this.graphWidth[0] - this.activeProfile.centerWidth) * 0.5, 0]);\n\n      this.xAxisLeftEl.each(function(d, i) {\n      \n        _this.xAxisLeft.scale(_this.xScaleLeft.copy().domain(_this.domains[i]).range([(_this.graphWidth[i] - _this.activeProfile.centerWidth) * 0.5, 0]))\n          .tickFormat(format)\n          .tickSizeInner(-_this.height)\n          .tickSizeOuter(0)\n          .tickPadding(6)\n          .tickSizeMinor(-_this.height, 0)\n          .labelerOptions({\n            scaleType: _this.model.marker.axis_x.scaleType,\n            toolMargin: margin,\n            limitMaxTickNumber: 6\n          });\n        d3.select(this)\n          .attr(\"transform\", \"translate(0,\" + _this.height + \")\")\n          .call(_this.xAxisLeft);\n        //hide left axis zero tick\n        const tickNodes = d3.select(this).selectAll(\".tick\").classed(\"vzb-hidden\", false).nodes();\n        d3.select(tickNodes[tickNodes.length - 1]).classed(\"vzb-hidden\", true);\n      });\n    }\n\n    const isRTL = this.model.locale.isRTL();\n    \n    this.bars.attr(\"transform\", (d, i) => \"translate(\" + translateX[i] + \",0)\");\n    this.lockedPaths.attr(\"transform\", (d, i) => \"translate(\" + translateX[i] + \",0)\");\n    this.labels.attr(\"transform\", (d, i) => \"translate(\" + translateX[i] + \",0)\");\n\n    const titleSpace = (i) => (translateX[i] - this.activeProfile.titlesSpacing) < 0 ? _this.activeProfile.centerWidth * 0.5 : _this.activeProfile.titlesSpacing;\n\n    this.title\n      .attr(\"x\", (d, i) => this.twoSided ? translateX[i] - _this.activeProfile.centerWidth * 0.5 - titleSpace(i) : 0)\n      .style(\"text-anchor\", this.twoSided ? \"end\" : \"\")\n      .attr(\"y\", -margin.top * 0.275 - deltaMarginTop)\n      .each(function(d, i) {\n        _this.textEllipsis.wrap(this, _this.twoSided ? (_this.graphWidth[i] + margin.between - titleSpace(i)) * 0.5 : _this.graphWidth[i] +  margin.between)\n      });\n    this.titleRight\n      .attr(\"x\", (d, i) => translateX[i] - _this.activeProfile.centerWidth * 0.5 + titleSpace(i))\n      .attr(\"y\", -margin.top * 0.275 - deltaMarginTop)\n      .each(function(d, i) {\n        _this.textEllipsis.wrap(this, (_this.graphWidth[i] + margin.between - titleSpace(i)) * 0.5)\n      });\n    this.titleCenter\n      .attr(\"x\", (d, i) => this.twoSided ? translateX[i] - _this.activeProfile.centerWidth * 0.5: _this.graphWidth[i] * 0.5)\n      .style(\"text-anchor\", \"middle\")\n      .attr(\"y\", (-margin.top - deltaMarginTop)* 0.035 )\n      .each(function(d, i) {\n        _this.textEllipsis.wrap(this, _this.graphWidth[i] +  margin.between)\n      });\n\n    this.xTitleEl\n      .style(\"font-size\", infoElHeight + \"px\")\n      .attr(\"transform\", \"translate(\" + (isRTL ? margin.left + this.width : margin.left * 0.4) + \",\" + (margin.top * 0.35) + \")\");\n\n    if (this.xInfoEl.select(\"svg\").node()) {\n      const titleBBox = this.xTitleEl.node().getBBox();\n      const t = utils.transform(this.xTitleEl.node());\n      const hTranslate = isRTL ? (titleBBox.x + t.translateX - infoElHeight * 1.4) : (titleBBox.x + t.translateX + titleBBox.width + infoElHeight * 0.4);\n\n      this.xInfoEl.select(\"svg\")\n        .attr(\"width\", infoElHeight + \"px\")\n        .attr(\"height\", infoElHeight + \"px\");\n      this.xInfoEl.attr(\"transform\", \"translate(\"\n        + hTranslate + \",\"\n        + (t.translateY - infoElHeight * 0.8) + \")\");\n    }\n\n    const yearLabelOptions = {\n      topOffset: this.ui.presentation ? 25 : this.getLayoutProfile() === \"small\" ? 10 : 15,\n      rightOffset: this.getLayoutProfile() === \"small\" ? 5 : 10,\n      xAlign: \"right\",\n      yAlign: \"top\",\n      heightRatio: this.ui.presentation ? 0.5 : 0.5,\n      //widthRatio: this.getLayoutProfile() === \"large\" ? 3 / 8 : 5 / 10\n    };\n\n    //year resized\n    this.year\n      .setConditions(yearLabelOptions)\n      .resize(this.fullWidth, margin.top);\n    this.yearLocked.attr(\"x\", isRTL? margin.left * 0.4 : this.width + margin.left + margin.right - 10).attr(\"y\", (margin.top - deltaMarginTop) * (this.getLayoutProfile() === \"large\" ? 1.27 : 1.27));\n\n  },\n\n  updateBarsOpacity(duration) {\n    const _this = this;\n\n    const OPACITY_HIGHLT = 1.0;\n    const OPACITY_HIGHLT_DIM = this.model.marker.opacityHighlightDim;\n    const OPACITY_SELECT = 1.0;\n    const OPACITY_REGULAR = this.model.marker.opacityRegular;\n    const OPACITY_SELECT_DIM = this.model.marker.opacitySelectDim;\n\n    const nonSelectedOpacityZero = _this.model.marker.opacitySelectDim < 0.01;\n    const nonSelectedOpacityZeroFlag = nonSelectedOpacityZero != this.nonSelectedOpacityZero;\n    const someSelected = this.someSelected;\n    const someHighlighted = this.someHighlighted;\n\n    this.stackBars.each(function(d) {\n      const isSelected =  someSelected ? _this.model.marker.isSelected(d) : false;\n      const isHighlighted = someHighlighted ? _this.model.marker.isHighlighted(d): false;\n      const bar = d3.select(this);\n\n      bar.style(\"opacity\", isHighlighted ? OPACITY_HIGHLT\n        :\n        someSelected ? (isSelected ? OPACITY_SELECT : OPACITY_SELECT_DIM)\n          :\n          someHighlighted ? OPACITY_HIGHLT_DIM : OPACITY_REGULAR)\n        .style(\"stroke\", isSelected ? \"#333\" : null)\n        .style(\"y\", isSelected ? \"0.5px\" : null);\n\n      if(nonSelectedOpacityZeroFlag) {\n        bar.style(\"pointer-events\", !someSelected || !nonSelectedOpacityZero || isSelected ? \"visible\" : \"none\");\n      }\n    });\n\n    this.nonSelectedOpacityZero = _this.model.marker.opacitySelectDim < 0.01;\n  }\n\n});\n\nexport default PopByAge;\n\n\n\n// WEBPACK FOOTER //\n// ./src/component.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles.scss\n// module id = 2\n// module chunks = 0 1","module.exports = \"<!-- PopByAge Component -->\\n<svg class=\\\"vzb-popbyage\\\">\\n    <g class=\\\"vzb-bc-header\\\">\\n        <g class=\\\"vzb-bc-axis-x-title\\\"></g>\\n        <g class=\\\"vzb-bc-axis-x-info vzb-noexport\\\"></g>\\n        <g class=\\\"vzb-bc-year-now\\\"></g>\\n        <text class=\\\"vzb-bc-year vzb-bc-year-locked\\\"></text>\\n    </g>\\n    <g class=\\\"vzb-bc-graph\\\">\\n        <text class=\\\"vzb-bc-title\\\"></text>\\n        <text class=\\\"vzb-bc-title vzb-bc-title-right\\\"></text>\\n        <text class=\\\"vzb-bc-title vzb-bc-title-center\\\"></text>\\n\\n        <g class=\\\"vzb-bc-axis-y-title\\\"></g>\\n\\n        <g class=\\\"vzb-bc-axis-y\\\"></g>\\n\\n        <svg class=\\\"vzb-bc-bars-crop\\\">\\n            <g class=\\\"vzb-bc-bars\\\"></g>\\n        </svg>\\n        \\n        <svg class=\\\"vzb-bc-locked-crop\\\">\\n            <g class=\\\"vzb-bc-paths\\\"></g>\\n        </svg>\\n\\n        <g class=\\\"vzb-bc-axis-x\\\"></g>\\n        <g class=\\\"vzb-bc-axis-x vzb-bc-axis-x-left\\\"></g>\\n\\n        <svg class=\\\"vzb-bc-labels-crop\\\">\\n            <g class=\\\"vzb-bc-labels\\\"></g>\\n        </svg>\\n\\n        <g class=\\\"vzb-bc-axis-labels\\\">\\n            <!-- <text class=\\\"vzb-x_label\\\">Lifespan</text>\\n                  <text class=\\\"vzb-y_label\\\">Lifespan</text> -->\\n        </g>\\n    </g>\\n    <g class=\\\"vzb-bc-tooltip vzb-hidden\\\">\\n        <rect class=\\\"vzb-tooltip-border\\\"></rect>\\n        <text class=\\\"vzb-tooltip-text\\\"></text>\\n    </g>\\n</svg>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/template.html\n// module id = 3\n// module chunks = 0 1"],"sourceRoot":""}